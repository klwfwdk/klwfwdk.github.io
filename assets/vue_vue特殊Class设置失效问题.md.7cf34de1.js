import{_ as s,o,c as t,O as a}from"./chunks/framework.d98a00e9.js";const C=JSON.parse('{"title":"vue使用内联特殊css属性失效的问题探究","description":"","frontmatter":{"title":"vue使用内联特殊css属性失效的问题探究","date":"2020-10-1","tags":["分享","采坑"],"categories":["vue","dom"],"publish":true},"headers":[],"relativePath":"vue/vue特殊Class设置失效问题.md","filePath":"vue/vue特殊Class设置失效问题.md","lastUpdated":1683220251000}'),n={name:"vue/vue特殊Class设置失效问题.md"},l=a(`<h2 id="前言" tabindex="-1">前言 <a class="header-anchor" href="#前言" aria-label="Permalink to &quot;前言&quot;">​</a></h2><p>这篇博客是笔者在国庆节在机场候机时候机时开始写的,主要讨论一下vue中为dom设置特殊内联css属性无效的原因和解决方法.</p><h2 id="为什么要设置特殊的内联css属性" tabindex="-1">为什么要设置特殊的内联css属性 <a class="header-anchor" href="#为什么要设置特殊的内联css属性" aria-label="Permalink to &quot;为什么要设置特殊的内联css属性&quot;">​</a></h2><p>使用excellentexport导出的Excel时遇到文本被excel识别为小数,如<code>1.10</code>被识别为了<code>1.1</code>,身份证被识别为科学计数法等问题,经过检索,可以通过得对应的css属性来解决这个问题.通过对对应的class设置属性发现导出后无效果,查看导出的文件发现这个插件其实就是将单表所在的html拷贝出来,然后在外部进行一些包装,所以对应的css属性需要内联.</p><h2 id="vue对内联css的处理方式" tabindex="-1">vue对内联css的处理方式 <a class="header-anchor" href="#vue对内联css的处理方式" aria-label="Permalink to &quot;vue对内联css的处理方式&quot;">​</a></h2><p>当发现直接给对应的dom使用<code>style</code>或者<code>:style</code>并没有任何效果后,对vue处理模板内的内联的方式进行了探究.</p><p>vue会把</p><div class="language-html"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">img</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">alt</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Vue logo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./assets/logo.png</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">test:2333</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">:style</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">tempStyle</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>编译为</p><div class="language-JavaScript"><button title="Copy Code" class="copy"></button><span class="lang">JavaScript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#82AAFF;">createElement</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">img</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">staticStyle</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">test</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">2333</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> e</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">tempStyle</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">attrs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">alt</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Vue logo</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F07178;">src</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">r</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cf05</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span></code></pre></div><p>然后<code>staticStyle</code>与<code>style</code>两个字段会交由<code>CSS 样式声明对象(CSSStyleDeclaration)</code>响应式的添加到对应的dom上.经过多次实验发现通过<code>setProperty()</code>只能设置标准的css属性,或者以<code>--</code>开头的属性.其他的都会失败.例如</p><div class="language-JavaScript"><button title="Copy Code" class="copy"></button><span class="lang">JavaScript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">//有效</span></span>
<span class="line"><span style="color:#A6ACCD;">  document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setProperty</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">--test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yellow</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">important</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">//无效</span></span>
<span class="line"><span style="color:#A6ACCD;">  document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setProperty</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yellow</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">important</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">//无效</span></span>
<span class="line"><span style="color:#A6ACCD;">  document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">body</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setProperty</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">-test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">yellow</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">important</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><p>但是从下表可以发现,需要的添加的属性不满足上述条件</p><table><thead><tr><th>CSS代码</th><th>说明或示例</th></tr></thead><tbody><tr><td>mso-number-format:&quot;0&quot;</td><td>NO Decimals</td></tr><tr><td>mso-number-format:&quot;0.000&quot;</td><td>3 Decimals</td></tr><tr><td>mso-number-format:&quot;#,##0.000&quot;</td><td>Comma with 3 dec</td></tr><tr><td>mso-number-format:&quot;mm/dd/yy&quot;</td><td>Date7</td></tr><tr><td>mso-number-format:&quot;mmmm\\ d,\\ yyyy&quot;</td><td>Date9</td></tr><tr><td>mso-number-format:&quot;m/d/yy\\ h:mm\\ AM/PM&quot;</td><td>D -T AMPM</td></tr><tr><td>mso-number-format:&quot;Short Date&quot;</td><td>01/03/1998</td></tr><tr><td>mso-number-format:&quot;Medium Date&quot;</td><td>01-mar-98</td></tr><tr><td>mso-number-format:&quot;d-mmm-yyyy&quot;</td><td>01-mar-1998</td></tr><tr><td>mso-number-format:&quot;Short Time&quot;</td><td>5:16</td></tr><tr><td>mso-number-format:&quot;Medium Time&quot;</td><td>5:16 am</td></tr><tr><td>mso-number-format:&quot;Long Time&quot;</td><td>5:16:21:00</td></tr><tr><td>mso-number-format:&quot;Percent&quot;</td><td>Percent - two decimals</td></tr><tr><td>mso-number-format:&quot;0%&quot;</td><td>Percent - no decimals</td></tr><tr><td>mso-number-format:&quot;0.E+00&quot;</td><td>Scientific Notation</td></tr><tr><td>mso-number-format:&quot;@&quot;</td><td>Text</td></tr><tr><td>mso-number-format:&quot;#\\ ???/???&quot;</td><td>Fractions - up to 3 digits (312/943)</td></tr><tr><td>mso-number-format:&quot;\\0022£\\0022#,##0.00&quot;</td><td>£12.76</td></tr><tr><td>mso-number-format:&quot;#,##0.00_ ;[Red]-#,##0.00\\ “</td><td>2 decimals, negative numbers in red and signed (1.56 -1.56)</td></tr></tbody></table><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to &quot;解决方案&quot;">​</a></h2><p>所以需要使用另外的方法设置当前dom的class,这里找到了<code>dom.setAttribute</code>,值得注意的是,这个方法会覆盖当前的class,所以需要处理原有值和特殊class的关系.但是操作dom会比较麻烦.没有直接给dom写class方便.这里就需要用到vue的另外一个功能:指令<code>(directive)</code>.可以通过编写特殊的指令完成上述操作,减少频繁重复的调用<code>dom.setAttribute</code></p>`,16),e=[l];function p(r,c,D,y,F,d){return o(),t("div",null,e)}const m=s(n,[["render",p]]);export{C as __pageData,m as default};
